import{a as r,C as v,i as y}from"./index-73320e29.js";import{i as g}from"./index-7ae24b1e.js";var p=document.getElementById("calendar"),o,f,s,d;document.getElementById("bulkSelectDecision").addEventListener("click",function(){var e=document.getElementsByClassName("day-of-week-checks"),n=[];if(s===1){alert("シフト確定済みのためシフトを追加できません");return}if(d===1){alert("シフト公開済みのためシフトを追加できません");return}for(let a=0;a<7;a++)e[a].checked===!0&&n.push(e[a].value);var t=document.getElementsByName("shift-checks"),l="";for(let a=0;a<3;a++)t[a].checked===!0&&(l=t[a].value);n.length!=0&&l!=""&&r.post("/user/home/shift-hope/shift-bulk-add",{display_start_day:o,display_end_day:f,shift_checked:l,day_of_week_checked_list:n}).then(a=>{console.log(a),document.location.reload()}).catch(()=>{alert("登録に失敗しました")})});document.getElementById("bulkDeleteDecision").addEventListener("click",function(e,n,t){if(s===1){alert("シフト確定済みのためシフトを削除できません");return}if(d===1){alert("シフト公開済みのためシフトを削除できません");return}r.post("/user/home/shift-hope/shift-bulk-delete",{display_start_day:o,display_end_day:f}).then(()=>{document.location.reload()}).catch(()=>{alert("登録に失敗しました")})});document.getElementById("userShiftConfirmDecision").addEventListener("click",function(e,n,t){r.post("/user/home/shift-hope/user-shift-confirm",{display_start_day:o}).then(l=>{l.data?(document.getElementById("userShiftConfirmButton").innerText="確定取り消し",document.getElementById("userShiftConfirmText").innerText="希望シフト:  確定",document.getElementById("userShiftConfirmModalMessage").innerText="希望シフトを取り消しますか？",s=1):(document.getElementById("userShiftConfirmButton").innerText="シフト確定",document.getElementById("userShiftConfirmText").innerText="希望シフト:  未確定",document.getElementById("userShiftConfirmModalMessage").innerText="希望シフトを確定しますか？",s=0)}).catch(()=>{alert("登録に失敗しました")})});var h=new Date,u=new Date(h);u.setMonth(h.getMonth()+1);let c=new v(p,{plugins:[g,y],initialView:"dayGridMonth",initialDate:u,headerToolbar:{left:"",center:"title",right:""},locale:"ja",selectable:!0,select:function(e){var n=e.start.toISOString().slice(0,10),t=new Date(e.end.getTime()-24*60*60*1e3).toISOString().slice(0,10);if(n!==t){alert("一日だけ選択してください");return}if(s===1){alert("シフト確定済みのためシフトを追加できません");return}if(d===1){alert("シフト公開済みのためシフトを追加できません");return}var l=null;$("#exampleModal").modal("show").on("click",function(){$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")}),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").on("click",function(){l=$(this).text(),l&&r.post("/user/home/shift-hope/shift-add",{start_date:e.start.valueOf(),end_date:e.end.valueOf(),shift_type:l}).then(()=>{document.location.reload()}).catch(()=>{alert("登録に失敗しました")}),$("#exampleModal").hide(),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")})},events:function(e,n,t){o=e.start.valueOf(),f=e.end.valueOf();const l=r.post("shift-hope/shift-get",{start_date:e.start.valueOf(),end_date:e.end.valueOf()}),a=r.post("shift-hope/shift-status-get",{start_date:e.start.valueOf(),end_date:e.end.valueOf()});Promise.all([l,a]).then(i=>{const m=i[0].data,_=i[1].data;c.removeAllEvents(),console.log(i),n([...m,..._])}).catch(()=>{document.location.reload()}),r.post("../../admin/shift-planning/shift-planning-add",{start_date:e.start.valueOf(),end_date:e.end.valueOf()}).then(i=>{}).catch(i=>{alert("登録に失敗しました")}),r.post("/user/home/shift-hope/user-shift-confirm-status-get",{display_start_day:o}).then(i=>{s=i.data[0],d=i.data[1],console.log(i.data),s?(document.getElementById("userShiftConfirmButton").innerText="確定取り消し",document.getElementById("userShiftConfirmText").innerText="希望シフト: 確定",document.getElementById("userShiftConfirmModalMessage").innerText="希望シフトを取り消しますか？"):(document.getElementById("userShiftConfirmButton").innerText="シフト確定",document.getElementById("userShiftConfirmText").innerText="希望シフト:  未確定",document.getElementById("userShiftConfirmModalMessage").innerText="希望シフトを確定しますか？")}).catch(i=>{alert("登録に失敗しました")})},eventClick:function(e){var n=e.event._def.title;if(n.trim().charAt(0)==="_"||n===""){var t=null;$("#exampleModal").modal("show").on("click",function(){$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")}),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").on("click",function(){if(s===1){alert("シフト確定済みのためシフトを追加できません");return}if(d===1){alert("シフト公開済みのためシフトを追加できません");return}t=$(this).text(),console.log(t),t&&(console.log(),r.post("/user/home/shift-hope/shift-add",{start_date:e.event._instance.range.start.valueOf(),end_date:e.event._instance.range.end.valueOf(),shift_type:t}).then(()=>{c.addEvent({title:t,start:e.event._instance.range.start,end:e.event._instance.range.end,allDay:!0},!0),document.location.reload()}).catch(()=>{alert("登録に失敗しました")})),$("#exampleModal").hide(),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")})}else{if(s===1){alert("シフト確定済みのためシフトを削除できません");return}if(d===1){alert("シフト公開済みのためシフトを削除できません");return}confirm("削除しますか？")&&(r.post("shift-hope/shift-delete",{start_date:e.event._instance.range.start.valueOf(),end_date:e.event._instance.range.end.valueOf()}).then(()=>{document.location.reload()}).catch(()=>{alert("削除に失敗しました")}),e.event.remove())}}});c.render();
