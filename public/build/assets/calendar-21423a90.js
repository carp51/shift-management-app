import{a as l,C as _,i as v}from"./index-73320e29.js";import{i as y}from"./index-7ae24b1e.js";var g=document.getElementById("calendar"),d,o,r,s;document.getElementById("bulkSelectDecision").addEventListener("click",function(){var e=document.getElementsByClassName("day-of-week-checks"),n=[];if(r===1){alert("シフト確定済みのためシフトを追加できません");return}if(s===1){alert("シフト公開済みのためシフトを追加できません");return}for(let t=0;t<7;t++)e[t].checked===!0&&n.push(e[t].value);var a=document.getElementsByName("shift-checks"),i="";for(let t=0;t<3;t++)a[t].checked===!0&&(i=a[t].value);n.length!=0&&i!=""&&l.post("/user/home/shift-hope/shift-bulk-add",{display_start_day:d,display_end_day:o,shift_checked:i,day_of_week_checked_list:n}).then(()=>{document.location.reload()}).catch(()=>{alert("一括登録に失敗しました")})});document.getElementById("bulkDeleteDecision").addEventListener("click",function(e,n,a){if(r===1){alert("シフト確定済みのためシフトを削除できません");return}if(s===1){alert("シフト公開済みのためシフトを削除できません");return}l.post("/user/home/shift-hope/shift-bulk-delete",{display_start_day:d,display_end_day:o}).then(()=>{document.location.reload()}).catch(()=>{alert("一括削除に失敗しました")})});document.getElementById("userShiftConfirmDecision").addEventListener("click",function(e,n,a){l.post("/user/home/shift-hope/user-shift-confirm",{display_start_day:d}).then(i=>{i.data?(document.getElementById("userShiftConfirmButton").innerText="確定取り消し",document.getElementById("userShiftConfirmText").innerText="希望シフト:  確定",document.getElementById("userShiftConfirmModalMessage").innerText="希望シフトを取り消しますか？",r=1):(document.getElementById("userShiftConfirmButton").innerText="シフト確定",document.getElementById("userShiftConfirmText").innerText="希望シフト:  未確定",document.getElementById("userShiftConfirmModalMessage").innerText="希望シフトを確定しますか？",r=0)}).catch(()=>{alert("シフト確定の処理に失敗しました")})});var f=new Date,h=new Date(f);h.setMonth(f.getMonth()+1);let c=new _(g,{plugins:[y,v],initialView:"dayGridMonth",initialDate:h,headerToolbar:{left:"",center:"title",right:""},locale:"ja",selectable:!0,select:function(e){var n=e.start.toISOString().slice(0,10),a=new Date(e.end.getTime()-24*60*60*1e3).toISOString().slice(0,10);if(n!==a){alert("一日だけ選択してください");return}if(r===1){alert("シフト確定済みのためシフトを追加できません");return}if(s===1){alert("シフト公開済みのためシフトを追加できません");return}var i=null;$("#exampleModal").modal("show").on("click",function(){$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")}),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").on("click",function(){i=$(this).text(),i&&l.post("/user/home/shift-hope/shift-add",{start_date:e.start.valueOf(),end_date:e.end.valueOf(),shift_type:i}).then(()=>{document.location.reload()}).catch(()=>{alert("シフト登録に失敗しました")}),$("#exampleModal").hide(),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")})},events:function(e,n){d=e.start.valueOf(),o=e.end.valueOf();const a=l.post("shift-hope/shift-get",{start_date:e.start.valueOf(),end_date:e.end.valueOf()}),i=l.post("shift-hope/shift-status-get",{start_date:e.start.valueOf(),end_date:e.end.valueOf()});Promise.all([a,i]).then(t=>{const u=t[0].data,m=t[1].data;c.removeAllEvents(),n([...u,...m])}).catch(()=>{document.location.reload()}),l.post("../../admin/shift-planning/shift-planning-add",{start_date:e.start.valueOf(),end_date:e.end.valueOf()}).then(()=>{}).catch(()=>{alert("シフト人数の登録に失敗しました")}),l.post("/user/home/shift-hope/user-shift-confirm-status-get",{display_start_day:d}).then(t=>{r=t.data[0],s=t.data[1],r?(document.getElementById("userShiftConfirmButton").innerText="確定取り消し",document.getElementById("userShiftConfirmText").innerText="希望シフト: 確定",document.getElementById("userShiftConfirmModalMessage").innerText="希望シフトを取り消しますか？"):(document.getElementById("userShiftConfirmButton").innerText="シフト確定",document.getElementById("userShiftConfirmText").innerText="希望シフト:  未確定",document.getElementById("userShiftConfirmModalMessage").innerText="希望シフトを確定しますか？")}).catch(()=>{alert("ユーザーのシフト確定状態の取得に失敗しました")})},eventClick:function(e){var n=e.event._def.title;if(n.trim().charAt(0)==="_"||n===""){var a=null;$("#exampleModal").modal("show").on("click",function(){$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")}),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").on("click",function(){if(r===1){alert("シフト確定済みのためシフトを追加できません");return}if(s===1){alert("シフト公開済みのためシフトを追加できません");return}a=$(this).text(),a&&l.post("/user/home/shift-hope/shift-add",{start_date:e.event._instance.range.start.valueOf(),end_date:e.event._instance.range.end.valueOf(),shift_type:a}).then(()=>{c.addEvent({title:a,start:e.event._instance.range.start,end:e.event._instance.range.end,allDay:!0},!0),document.location.reload()}).catch(()=>{alert("シフトの登録に失敗しました")}),$("#exampleModal").hide(),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")})}else{if(r===1){alert("シフト確定済みのためシフトを削除できません");return}if(s===1){alert("シフト公開済みのためシフトを削除できません");return}confirm("削除しますか？")&&(l.post("shift-hope/shift-delete",{start_date:e.event._instance.range.start.valueOf(),end_date:e.event._instance.range.end.valueOf()}).then(()=>{document.location.reload()}).catch(()=>{alert("削除に失敗しました")}),e.event.remove())}}});c.render();
