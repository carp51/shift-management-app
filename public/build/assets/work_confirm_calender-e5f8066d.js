import{a as r,C as h,i as f}from"./index-73320e29.js";import{i as m}from"./index-3666857a.js";var v=document.getElementById("work_confirm_calendar"),c=new Date,d=new Date(c);d.setMonth(c.getMonth()+1);var l,o,s=0;document.getElementById("shiftTempCreate").addEventListener("click",function(e){confirm("従業員の希望シフトを従業員に公開するシフトに上書きしますか？")&&r.post("/user/work/shift-temp-create",{start_date:l,end_date:o}).then(()=>{document.location.reload()}).catch(()=>{alert("登録に失敗しました")})});document.getElementById("shiftShow").addEventListener("click",function(e){if(s)var n="シフトの公開を取り消しますか？";else var n="シフトを公開しますか";confirm(n)&&r.post("/user/work/confirm/shift-show",{display_start_date:l}).then(t=>{var a=t.data;a==1?document.getElementById("shiftShow").innerText="シフトの公開を取り消す":document.getElementById("shiftShow").innerText="シフトを公開する"}).catch(()=>{alert("登録に失敗しました")})});let i=new h(v,{schedulerLicenseKey:"CC-Attribution-NonCommercial-NoDerivatives",plugins:[f,m],initialView:"resourceTimelineMonth",initialDate:d,headerToolbar:{left:"prev",center:"title",right:"next"},locale:"ja",contentHeight:"auto",editable:!0,resourceAreaHeaderContent:"従業員",resources:[],selectable:!0,select:function(e){var n=e.start.toISOString().slice(0,10),t=new Date(e.end.getTime()-24*60*60*1e3).toISOString().slice(0,10);if(n!==t){alert("一日だけ選択してください");return}var a=null;$("#exampleModal").modal("show").on("click",function(){$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")}),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").on("click",function(){a=$(this).text(),a&&r.post("/user/work/confirm/shift-add",{start_date:e.start.valueOf(),end_date:e.end.valueOf(),shift_type:a,user_id:e.resource._resource.id}).then(()=>{console.log(e.start),i.addEvent({title:a,start:e.start,end:e.end,resourceId:e.resource._resource.id,allDay:!0})}).catch(()=>{alert("登録に失敗しました")}),$("#exampleModal").hide(),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")})},events:function(e,n){l=e.start.valueOf(),o=e.end.valueOf(),r.post("work/all-member-get",{display_start_day:e.start.valueOf(),display_status:"confirm"}).then(t=>{var a=t.data,u=a;i.setOption("resources",u)}).catch(()=>{alert("登録に失敗しました")}),r.post("work/confirm/all-shift-get",{start_date:e.start.valueOf(),end_date:e.end.valueOf()}).then(t=>{n(t.data)}).catch(()=>{alert("登録に失敗しました")}),r.post("work/confirm/shift-show-status-get",{start_date:e.start.valueOf()}).then(t=>{t.data?(document.getElementById("shiftShow").innerText="シフトの公開を取り消す",s=1):(document.getElementById("shiftShow").innerText="シフトを公開する",s=0)}).catch(()=>{alert("登録に失敗しました")})},eventClick:function(e){confirm("削除しますか？")&&(r.post("work/confirm/shift-delete",{start_date:e.event._instance.range.start.valueOf(),end_date:e.event._instance.range.end.valueOf(),user_id:e.event._def.resourceIds}).then(()=>{}).catch(()=>{alert("削除に失敗しました")}),e.event.remove())}});i.render();
