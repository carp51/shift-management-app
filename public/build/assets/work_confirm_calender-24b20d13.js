import{a as n,C as f,i as h}from"./index-73320e29.js";import{i as m}from"./index-3666857a.js";var v=document.getElementById("work_confirm_calendar"),d=new Date,o=new Date(d);o.setMonth(d.getMonth()+1);var s,c,i=0;document.getElementById("shiftTempCreate").addEventListener("click",function(e){confirm("従業員の希望シフトを従業員に公開するシフトに上書きしますか？")&&n.post("/user/work/shift-temp-create",{start_date:s,end_date:c}).then(()=>{document.location.reload()}).catch(()=>{alert("登録に失敗しました")})});document.getElementById("shiftShow").addEventListener("click",function(e){if(i)var a="シフトの公開を取り消しますか？";else var a="シフトを公開しますか";confirm(a)&&n.post("/user/work/confirm/shift-show",{display_start_date:s}).then(t=>{var r=t.data;r==1?document.getElementById("shiftShow").innerText="シフトの公開を取り消す":document.getElementById("shiftShow").innerText="シフトを公開する"}).catch(()=>{alert("登録に失敗しました")})});document.getElementById("shiftToExcel").addEventListener("click",function(e){n.post("/user/work/confirm/excel-file-get",{display_start_date:s,display_end_date:c},{responseType:"blob"}).then(a=>{saveAs(a.data,"myExcelFile.xlsx")}).catch(()=>{alert("エクセルを出力するのに失敗しました")})});let l=new f(v,{schedulerLicenseKey:"CC-Attribution-NonCommercial-NoDerivatives",plugins:[h,m],initialView:"resourceTimelineMonth",initialDate:o,headerToolbar:{left:"prev",center:"title",right:"next"},locale:"ja",contentHeight:"auto",editable:!0,resourceAreaHeaderContent:"従業員",resources:[],selectable:!0,select:function(e){var a=e.start.toISOString().slice(0,10),t=new Date(e.end.getTime()-24*60*60*1e3).toISOString().slice(0,10);if(a!==t){alert("一日だけ選択してください");return}var r=null;$("#exampleModal").modal("show").on("click",function(){$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")}),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").on("click",function(){r=$(this).text(),r&&n.post("/user/work/confirm/shift-add",{start_date:e.start.valueOf(),end_date:e.end.valueOf(),shift_type:r,user_id:e.resource._resource.id}).then(()=>{console.log(e.start),l.addEvent({title:r,start:e.start,end:e.end,resourceId:e.resource._resource.id,allDay:!0})}).catch(()=>{alert("登録に失敗しました")}),$("#exampleModal").hide(),$(".early-shift-btn, .late-shift-btn, .fulltime-shift-btn").off("click")})},events:function(e,a){s=e.start.valueOf(),c=e.end.valueOf(),n.post("work/all-member-get",{display_start_day:e.start.valueOf(),display_status:"confirm"}).then(t=>{var r=t.data,u=r;l.setOption("resources",u)}).catch(()=>{alert("登録に失敗しました")}),n.post("work/confirm/all-shift-get",{start_date:e.start.valueOf(),end_date:e.end.valueOf()}).then(t=>{a(t.data)}).catch(()=>{alert("登録に失敗しました")}),n.post("work/confirm/shift-show-status-get",{start_date:e.start.valueOf()}).then(t=>{t.data?(document.getElementById("shiftShow").innerText="シフトの公開を取り消す",i=1):(document.getElementById("shiftShow").innerText="シフトを公開する",i=0)}).catch(()=>{alert("登録に失敗しました")})},eventClick:function(e){confirm("削除しますか？")&&(n.post("work/confirm/shift-delete",{start_date:e.event._instance.range.start.valueOf(),end_date:e.event._instance.range.end.valueOf(),user_id:e.event._def.resourceIds}).then(()=>{}).catch(()=>{alert("削除に失敗しました")}),e.event.remove())}});l.render();
